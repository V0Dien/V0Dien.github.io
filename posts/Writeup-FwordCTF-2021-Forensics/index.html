<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="[Writeup] FwordCTF 2021 - Forensics" /><meta name="author" content="F4c3l3ss_" /><meta property="og:locale" content="en_US" /><meta name="description" content="listening?" /><meta property="og:description" content="listening?" /><link rel="canonical" href="https://v0dien.github.io/posts/Writeup-FwordCTF-2021-Forensics/" /><meta property="og:url" content="https://v0dien.github.io/posts/Writeup-FwordCTF-2021-Forensics/" /><meta property="og:site_name" content="V√¥ Di·ªán (@F4c3l3ss_)" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-29T00:00:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[Writeup] FwordCTF 2021 - Forensics" /><meta name="twitter:site" content="@F4c3l3ss_" /><meta name="twitter:creator" content="@F4c3l3ss_" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"F4c3l3ss_"},"description":"listening?","headline":"[Writeup] FwordCTF 2021 - Forensics","dateModified":"2021-09-02T21:57:42+07:00","datePublished":"2021-08-29T00:00:00+07:00","url":"https://v0dien.github.io/posts/Writeup-FwordCTF-2021-Forensics/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://v0dien.github.io/posts/Writeup-FwordCTF-2021-Forensics/"},"@context":"https://schema.org"}</script><title>[Writeup] FwordCTF 2021 - Forensics | V√¥ Di·ªán (@F4c3l3ss_)</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">V√¥ Di·ªán (@F4c3l3ss_)</a></div><div class="site-subtitle font-italic">Hi! üëª</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/V0Dien" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/F4c3l3ss_" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['v0dien','outlook.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>[Writeup] FwordCTF 2021 - Forensics</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[Writeup] FwordCTF 2021 - Forensics</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Aug 29, 2021, 12:00 AM +0700" > Aug 29 <i class="unloaded">2021-08-29T00:00:00+07:00</i> </span> by <span class="author"> F4c3l3ss_ </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Sep 2, 2021, 9:57 PM +0700" > Sep 2 <i class="unloaded">2021-09-02T21:57:42+07:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2292 words">12 min</span></div></div><div class="post-content"><h2 id="listening">listening?</h2><p>Ch√∫ng ta c√≥ ƒë·ªÅ b√†i l√† m·ªôt file pcap. Sau khi nh√¨n t·ªïng quan th√¨ t·∫•t c·∫£ c√°c package ƒë·ªÅu ch·ªâ chung v·ªÅ vi·ªác truy c·∫≠p <code class="language-plaintext highlighter-rouge">OAUTH2</code> c·ªßa google k√®m theo ƒë√≥ l√† c√°c bi·∫øn <code class="language-plaintext highlighter-rouge">client_secret</code>; <code class="language-plaintext highlighter-rouge">refresh_token</code>;‚Ä¶</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/blog/fword2021/2-flag-listening.JPG" alt="IMG" /></p><p>Response tr·∫£ l·ªói 403, y√™u c·∫ßu SSL v√¨ ƒë√¢y l√† truy v·∫•n HTTP n√™n server kh√¥ng ƒë√°p ·ª©ng y√™u c·∫ßu n√†y.</p><p>M√¨nh th·ª≠ v·ªõi burpsuite ƒë·ªÉ ki·ªÉm tra t√≠nh x√°c th·ª±c c·ªßa c√°c bi·∫øn tr√™n.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/blog/fword2021/7-burpsuite.JPG" alt="IMG" /></p><p>Ch√∫ √Ω ƒë·∫øn gi√° tr·ªã <code class="language-plaintext highlighter-rouge">Scope: https://www.googleapis.com/auth/gmail.readonly</code>. ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† c√°c gi√° tr·ªã, token n√†y s·∫Ω cho ph√©p ch√∫ng ta ƒë·ªçc ƒë∆∞·ª£c gmail th√¥ng qua API c·ªßa google.</p><p>T√¨m ki·∫øm tr√™n Internet, m√¨nh c√≥ ƒë∆∞·ª£c t√†i li·ªáu ƒë·∫ßy ƒë·ªß: <a href="https://developers.google.com/gmail/api/reference/rest">https://developers.google.com/gmail/api/reference/rest</a> v√† video h∆∞·ªõng d·∫´n: <a href="https://www.youtube.com/watch?v=x7uG1-H0aDU">https://www.youtube.com/watch?v=x7uG1-H0aDU</a>.</p><p>S·ª≠ d·ª•ng postman, set up m√¥i tr∆∞·ªùng theo video v√† c√≥ ƒë∆∞·ª£c flag:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/blog/fword2021/8-flag.JPG" alt="IMG" /></p><p>Flag: <code class="language-plaintext highlighter-rouge">FwordCTF{email_forensics_is_interesting_73489nn7n4891}</code></p><h2 id="crypt">Crypt</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/blog/fword2021/3-crypt-debai.JPG" alt="IMG" /></p><p>Download: <a href="https://drive.google.com/drive/folders/11KSbrlsTUuhPmGRx5uDjyaJvIR-_gBO8?usp=sharing">Link 1</a>; <a href="https://www.dropbox.com/sh/ipxelxzufpya66s/AAAFVi4cL-sdI0Hj9LGbMd8_a?dl=0">Link 2</a>; <a href="https://mega.nz/folder/0tQy0DCS#f5Q2kLogc7KJs4_y74HkEw">Link 3</a></p><p>ƒê·ªÅ b√†i y√™u c·∫ßu t√¨m 3 gi√° tr·ªã l√† ng√†y gi·ªù nh·∫≠n mail, ng∆∞·ªùi g·ª≠i v√† n·ªôi dung file ƒë√£ b·ªã m√£ h√≥a. Tr∆∞·ªõc h·∫øt th√¨ m√¨nh s·ª≠ d·ª•ng volatility xem th·ª≠ file dump n√†y c√≥ th·ªÉ c√≥ ƒë∆∞·ª£c th√¥ng tin t·ª´ c√°c ti·∫øn tr√¨nh ƒëang ch·∫°y hay kh√¥ng.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="nv">$python2</span> vol.py <span class="nt">-f</span> challenge.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 pslist
Volatility Foundation Volatility Framework 2.6.1
Offset<span class="o">(</span>V<span class="o">)</span>          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                          
<span class="nt">------------------</span> <span class="nt">--------------------</span> <span class="nt">------</span> <span class="nt">------</span> <span class="nt">------</span> <span class="nt">--------</span> <span class="nt">------</span> <span class="nt">------</span> <span class="nt">------------------------------</span> <span class="nt">------------------------------</span>
0xfffffa8018d41890 System                    4      0     76      492 <span class="nt">------</span>      0 2021-08-20 15:30:36 UTC+0000                                 
0xfffffa8019506650 smss.exe                236      4      2       29 <span class="nt">------</span>      0 2021-08-20 15:30:36 UTC+0000                                 
0xfffffa8019158060 csrss.exe               308    300      8      338      0      0 2021-08-20 15:30:42 UTC+0000                                 
0xfffffa8018db9840 wininit.exe             356    300      3       76      0      0 2021-08-20 15:30:43 UTC+0000                                 
0xfffffa8018dbe060 csrss.exe               364    348     10      222      1      0 2021-08-20 15:30:43 UTC+0000                                 
0xfffffa801a179060 winlogon.exe            392    348      4      114      1      0 2021-08-20 15:30:43 UTC+0000                                 
0xfffffa801a1b17c0 services.exe            452    356      7      183      0      0 2021-08-20 15:30:45 UTC+0000                                 
0xfffffa801a1b97f0 lsass.exe               460    356      6      511      0      0 2021-08-20 15:30:45 UTC+0000                                 
0xfffffa801a1c4b30 lsm.exe                 468    356     10      138      0      0 2021-08-20 15:30:45 UTC+0000                                 
0xfffffa801a234b30 svchost.exe             560    452     10      340      0      0 2021-08-20 15:30:49 UTC+0000                                 
0xfffffa801a25db30 svchost.exe             624    452      6      239      0      0 2021-08-20 15:30:50 UTC+0000                                 
0xfffffa801a29bb30 svchost.exe             724    452     20      443      0      0 2021-08-20 15:30:51 UTC+0000                                 
0xfffffa801a2b3920 svchost.exe             768    452     19      417      0      0 2021-08-20 15:30:51 UTC+0000                                 
0xfffffa801a2bb660 svchost.exe             792    452     32      908      0      0 2021-08-20 15:30:51 UTC+0000                                 
0xfffffa801a2e1b30 audiodg.exe             884    724      5      125      0      0 2021-08-20 15:30:53 UTC+0000                                 
0xfffffa801a30d890 svchost.exe             964    452     10      252      0      0 2021-08-20 15:30:55 UTC+0000                                 
0xfffffa801a354b30 svchost.exe             284    452     13      346      0      0 2021-08-20 15:30:57 UTC+0000                                 
0xfffffa801a3cb420 spoolsv.exe            1080    452     12      265      0      0 2021-08-20 15:31:01 UTC+0000                                 
0xfffffa801a38bb30 svchost.exe            1112    452     18      313      0      0 2021-08-20 15:31:01 UTC+0000                                 
0xfffffa801a44a340 armsvc.exe             1232    452      4       63      0      1 2021-08-20 15:31:03 UTC+0000                                 
0xfffffa801a4b4350 svchost.exe            1292    452     11      173      0      0 2021-08-20 15:31:05 UTC+0000                                 
0xfffffa80198b44e0 taskhost.exe           1784    452      9      174      1      0 2021-08-20 15:31:38 UTC+0000                                 
0xfffffa801a5e8b30 dwm.exe                1856    768      3       70      1      0 2021-08-20 15:31:38 UTC+0000                                 
0xfffffa801a5f7b30 explorer.exe           1884   1848     32      970      1      0 2021-08-20 15:31:39 UTC+0000                                 
0xfffffa80192f9b30 StikyNot.exe            512   1884      9      138      1      0 2021-08-20 15:31:43 UTC+0000                                 
0xfffffa801a677b30 SSScheduler.ex          832   1884      1       59      1      1 2021-08-20 15:31:44 UTC+0000                                 
0xfffffa801a28a060 SearchIndexer.         1344    452     12      645      0      0 2021-08-20 15:31:46 UTC+0000                                 
0xfffffa801a6cd910 SearchProtocol         1704   1344      6      310      0      0 2021-08-20 15:31:48 UTC+0000                                 
0xfffffa8019160630 notepad.exe             596    440      1       64      1      0 2021-08-20 15:32:29 UTC+0000                                 
0xfffffa8018e85b30 notepad.exe            1724    304      1       64      1      0 2021-08-20 15:32:58 UTC+0000                                 
0xfffffa80198c5870 sppsvc.exe             1852    452      4      141      0      0 2021-08-20 15:33:09 UTC+0000                                 
0xfffffa80198c5340 svchost.exe             304    452     13      317      0      0 2021-08-20 15:33:10 UTC+0000                                 
0xfffffa8019935b30 notepad.exe             840   1800      1       64      1      0 2021-08-20 15:33:10 UTC+0000                                 
0xfffffa801a17e060 notepad.exe             992   1780      1       64      1      0 2021-08-20 15:33:39 UTC+0000                                 
0xfffffa801a333630 notepad.exe            2164   1884      1       60      1      0 2021-08-20 15:34:24 UTC+0000                                 
0xfffffa801a6e0750 SearchFilterHo         2180   1344      4       85      0      0 2021-08-20 15:34:48 UTC+0000                                 
0xfffffa801a351630 WmiPrvSE.exe           2308    560      7      116      0      0 2021-08-20 15:35:09 UTC+0000                                 
0xfffffa801a3df610 DumpIt.exe             2512   1884      2       45      1      1 2021-08-20 15:35:16 UTC+0000                                 
0xfffffa801a3e2840 conhost.exe            2536    364      2       53      1      0 2021-08-20 15:35:16 UTC+0000
</pre></table></code></div></div><p>ƒê·ªÉ √Ω th√¨ th·∫•y r·∫•t nhi·ªÅu ti·∫øn tr√¨nh <code class="language-plaintext highlighter-rouge">notepad.exe</code> ƒëang ch·∫°y. Ch√∫ng ta c√≥ th·ªÉ dump memory c·ªßa ti·∫øn tr√¨nh ƒë·ªÉ xem n·ªôi dung file m√† notepad ƒëang m·ªü, tuy nhi√™n th√¨ n√≥ s·∫Ω h∆°i noise v√† nhi·ªÅu d·ªØ li·ªáu n√™n tr∆∞·ªõc ti√™n th√¨ m√¨nh d√πng plugin <code class="language-plaintext highlighter-rouge">cmdline</code> ƒë·ªÉ xem notepad ƒëang m·ªü nh·ªØng file n√†o v√† ƒë∆∞·ªùng d·∫´n c·ªßa nh·ªØng file n√†y tr√™n memory.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
</pre><td class="rouge-code"><pre><span class="nv">$python2</span> vol.py <span class="nt">-f</span> challenge.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 cmdline
Volatility Foundation Volatility Framework 2.6.1
<span class="k">************************************************************************</span>
System pid:      4
<span class="k">************************************************************************</span>
smss.exe pid:    236
Command line : <span class="se">\S</span>ystemRoot<span class="se">\S</span>ystem32<span class="se">\s</span>mss.exe
<span class="k">************************************************************************</span>
csrss.exe pid:    308
Command line : %SystemRoot%<span class="se">\s</span>ystem32<span class="se">\c</span>srss.exe <span class="nv">ObjectDirectory</span><span class="o">=</span><span class="se">\W</span>indows <span class="nv">SharedSection</span><span class="o">=</span>1024,20480,768 <span class="nv">Windows</span><span class="o">=</span>On <span class="nv">SubSystemType</span><span class="o">=</span>Windows <span class="nv">ServerDll</span><span class="o">=</span>basesrv,1 <span class="nv">ServerDll</span><span class="o">=</span>winsrv:UserServerDllInitialization,3 <span class="nv">ServerDll</span><span class="o">=</span>winsrv:ConServerDllInitialization,2 <span class="nv">ServerDll</span><span class="o">=</span>sxssrv,4 <span class="nv">ProfileControl</span><span class="o">=</span>Off <span class="nv">MaxRequestThreads</span><span class="o">=</span>16
<span class="k">************************************************************************</span>
wininit.exe pid:    356
Command line : wininit.exe
<span class="k">************************************************************************</span>
csrss.exe pid:    364
Command line : %SystemRoot%<span class="se">\s</span>ystem32<span class="se">\c</span>srss.exe <span class="nv">ObjectDirectory</span><span class="o">=</span><span class="se">\W</span>indows <span class="nv">SharedSection</span><span class="o">=</span>1024,20480,768 <span class="nv">Windows</span><span class="o">=</span>On <span class="nv">SubSystemType</span><span class="o">=</span>Windows <span class="nv">ServerDll</span><span class="o">=</span>basesrv,1 <span class="nv">ServerDll</span><span class="o">=</span>winsrv:UserServerDllInitialization,3 <span class="nv">ServerDll</span><span class="o">=</span>winsrv:ConServerDllInitialization,2 <span class="nv">ServerDll</span><span class="o">=</span>sxssrv,4 <span class="nv">ProfileControl</span><span class="o">=</span>Off <span class="nv">MaxRequestThreads</span><span class="o">=</span>16
<span class="k">************************************************************************</span>
winlogon.exe pid:    392
Command line : winlogon.exe
<span class="k">************************************************************************</span>
services.exe pid:    452
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\s</span>ervices.exe
<span class="k">************************************************************************</span>
lsass.exe pid:    460
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\l</span>sass.exe
<span class="k">************************************************************************</span>
lsm.exe pid:    468
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\l</span>sm.exe
<span class="k">************************************************************************</span>
svchost.exe pid:    560
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\s</span>vchost.exe <span class="nt">-k</span> DcomLaunch
<span class="k">************************************************************************</span>
svchost.exe pid:    624
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\s</span>vchost.exe <span class="nt">-k</span> RPCSS
<span class="k">************************************************************************</span>
svchost.exe pid:    724
Command line : C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\s</span>vchost.exe <span class="nt">-k</span> LocalServiceNetworkRestricted
<span class="k">************************************************************************</span>
svchost.exe pid:    768
Command line : C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\s</span>vchost.exe <span class="nt">-k</span> LocalSystemNetworkRestricted
<span class="k">************************************************************************</span>
svchost.exe pid:    792
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\s</span>vchost.exe <span class="nt">-k</span> netsvcs
<span class="k">************************************************************************</span>
audiodg.exe pid:    884
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\A</span>UDIODG.EXE 0x2d8
<span class="k">************************************************************************</span>
svchost.exe pid:    964
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\s</span>vchost.exe <span class="nt">-k</span> LocalService
<span class="k">************************************************************************</span>
svchost.exe pid:    284
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\s</span>vchost.exe <span class="nt">-k</span> NetworkService
<span class="k">************************************************************************</span>
spoolsv.exe pid:   1080
Command line : C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\s</span>poolsv.exe
<span class="k">************************************************************************</span>
svchost.exe pid:   1112
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\s</span>vchost.exe <span class="nt">-k</span> LocalServiceNoNetwork
<span class="k">************************************************************************</span>
armsvc.exe pid:   1232
Command line : <span class="s2">"C:</span><span class="se">\P</span><span class="s2">rogram Files (x86)</span><span class="se">\C</span><span class="s2">ommon Files</span><span class="se">\A</span><span class="s2">dobe</span><span class="se">\A</span><span class="s2">RM</span><span class="se">\1</span><span class="s2">.0</span><span class="se">\a</span><span class="s2">rmsvc.exe"</span>
<span class="k">************************************************************************</span>
svchost.exe pid:   1292
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\s</span>vchost.exe <span class="nt">-k</span> LocalServiceAndNoImpersonation
<span class="k">************************************************************************</span>
taskhost.exe pid:   1784
Command line : <span class="s2">"taskhost.exe"</span>
<span class="k">************************************************************************</span>
dwm.exe pid:   1856
Command line : <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\s</span><span class="s2">ystem32</span><span class="se">\D</span><span class="s2">wm.exe"</span>
<span class="k">************************************************************************</span>
explorer.exe pid:   1884
Command line : C:<span class="se">\W</span>indows<span class="se">\E</span>xplorer.EXE
<span class="k">************************************************************************</span>
StikyNot.exe pid:    512
Command line : <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\S</span><span class="s2">ystem32</span><span class="se">\S</span><span class="s2">tikyNot.exe"</span> 
<span class="k">************************************************************************</span>
SSScheduler.ex pid:    832
Command line : <span class="s2">"C:</span><span class="se">\P</span><span class="s2">rogram Files (x86)</span><span class="se">\M</span><span class="s2">cAfee Security Scan</span><span class="se">\3</span><span class="s2">.11.1664</span><span class="se">\S</span><span class="s2">SScheduler.exe"</span> 
<span class="k">************************************************************************</span>
SearchIndexer. pid:   1344
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\S</span>earchIndexer.exe /Embedding
<span class="k">************************************************************************</span>
SearchProtocol pid:   1704
Command line : <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\s</span><span class="s2">ystem32</span><span class="se">\S</span><span class="s2">earchProtocolHost.exe"</span> Global<span class="se">\U</span>sGthrFltPipeMssGthrPipe1_ Global<span class="se">\U</span>sGthrCtrlFltPipeMssGthrPipe1 1 <span class="nt">-2147483646</span> <span class="s2">"Software</span><span class="se">\M</span><span class="s2">icrosoft</span><span class="se">\W</span><span class="s2">indows Search"</span> <span class="s2">"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT; MS Search 4.0 Robot)"</span> <span class="s2">"C:</span><span class="se">\P</span><span class="s2">rogramData</span><span class="se">\M</span><span class="s2">icrosoft</span><span class="se">\S</span><span class="s2">earch</span><span class="se">\D</span><span class="s2">ata</span><span class="se">\T</span><span class="s2">emp</span><span class="se">\u</span><span class="s2">sgthrsvc"</span> <span class="s2">"DownLevelDaemon"</span> 
<span class="k">************************************************************************</span>
notepad.exe pid:    596
Command line : <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\s</span><span class="s2">ystem32</span><span class="se">\N</span><span class="s2">OTEPAD.EXE"</span> C:<span class="se">\U</span>sers<span class="se">\S</span>emahAB<span class="se">\D</span>ownloads<span class="se">\S</span>ecret content<span class="se">\f</span>lag.txt.asc
<span class="k">************************************************************************</span>
notepad.exe pid:   1724
Command line : <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\s</span><span class="s2">ystem32</span><span class="se">\N</span><span class="s2">OTEPAD.EXE"</span> C:<span class="se">\U</span>sers<span class="se">\S</span>emahAB<span class="se">\A</span>ppData<span class="se">\R</span>oaming<span class="se">\T</span>hunderbird<span class="se">\P</span>rofiles<span class="se">\g</span>b1i6asd.default-release<span class="se">\I</span>mapMail<span class="se">\i</span>map.yandex.com<span class="se">\I</span>NBOX
<span class="k">************************************************************************</span>
sppsvc.exe pid:   1852
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\s</span>ppsvc.exe
<span class="k">************************************************************************</span>
svchost.exe pid:    304
Command line : C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\s</span>vchost.exe <span class="nt">-k</span> secsvcs
<span class="k">************************************************************************</span>
notepad.exe pid:    840
Command line : <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\s</span><span class="s2">ystem32</span><span class="se">\N</span><span class="s2">OTEPAD.EXE"</span> C:<span class="se">\U</span>sers<span class="se">\S</span>emahAB<span class="se">\A</span>ppData<span class="se">\R</span>oaming<span class="se">\T</span>hunderbird<span class="se">\P</span>rofiles<span class="se">\g</span>b1i6asd.default-release<span class="se">\I</span>mapMail<span class="se">\i</span>map.yandex.com<span class="se">\S</span>pam
<span class="k">************************************************************************</span>
notepad.exe pid:    992
Command line : <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\s</span><span class="s2">ystem32</span><span class="se">\N</span><span class="s2">OTEPAD.EXE"</span> C:<span class="se">\U</span>sers<span class="se">\S</span>emahAB<span class="se">\A</span>ppData<span class="se">\R</span>oaming<span class="se">\T</span>hunderbird<span class="se">\P</span>rofiles<span class="se">\g</span>b1i6asd.default-release<span class="se">\I</span>mapMail<span class="se">\i</span>map.yandex.com<span class="se">\T</span>rash
<span class="k">************************************************************************</span>
notepad.exe pid:   2164
Command line : <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\s</span><span class="s2">ystem32</span><span class="se">\n</span><span class="s2">otepad.exe"</span> 
<span class="k">************************************************************************</span>
SearchFilterHo pid:   2180
Command line : <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\s</span><span class="s2">ystem32</span><span class="se">\S</span><span class="s2">earchFilterHost.exe"</span> 0 504 508 516 65536 512 
<span class="k">************************************************************************</span>
WmiPrvSE.exe pid:   2308
Command line : C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\w</span>bem<span class="se">\w</span>miprvse.exe
<span class="k">************************************************************************</span>
DumpIt.exe pid:   2512
Command line : <span class="s2">"C:</span><span class="se">\U</span><span class="s2">sers</span><span class="se">\S</span><span class="s2">emahAB</span><span class="se">\D</span><span class="s2">ownloads</span><span class="se">\D</span><span class="s2">umpIt.exe"</span> 
<span class="k">************************************************************************</span>
conhost.exe pid:   2536
Command line : <span class="se">\?</span>?<span class="se">\C</span>:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\c</span>onhost.exe
</pre></table></code></div></div><p>Kh√° nhi·ªÅu th√¥ng tin hay ho, bao g·ªìm n·ªôi dung inbox c·ªßa email, spam, trash v√† c√πng v·ªõi ƒë√≥ l√† file <code class="language-plaintext highlighter-rouge">flag.txt.asc</code>, ƒë√¢y c√≥ th·ªÉ l√† m·∫£nh gh√©p ƒë·∫ßu ti√™n trong flag. Dump file n√†y cho m√¨nh k·∫øt qu·∫£:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="nv">$python2</span> vol.py <span class="nt">-f</span> challenge.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 filescan | <span class="nb">grep</span> <span class="s2">".txt.asc"</span>
Volatility Foundation Volatility Framework 2.6.1
0x000000007fb5d2e0     16      0 R--rw- <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume2<span class="se">\U</span>sers<span class="se">\S</span>emahAB<span class="se">\D</span>ownloads<span class="se">\S</span>ecret content<span class="se">\f</span>lag.txt.asc
<span class="nv">$python2</span> vol.py <span class="nt">-f</span> challenge.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 dumpfiles <span class="nt">-Q</span> 0x000000007fb5d2e0 <span class="nt">-D</span> <span class="nb">.</span>
<span class="nv">$cat</span> flag.txt.asc
<span class="nt">-----BEGIN</span> PGP MESSAGE-----

hQIMA6mGMG+kfeOaAQ/+K8a+2BQVT+Ixk6xJKytj0xbDUqfw7FUQuKLjWBcxddbn
hd8eKmWIswUYpV3PmluCqJE5LRkdpX3Rdu/iK2ZRNyK7fGA3R3r3KFiBn5qKj0S4
D47LqwDE/fpo5YUGt3GH6Cpujv3DrdIpXcn2yFZLBiho5415bcTn2D3qm/H6uz9N
JFzved20D05OxTjj+a4s8Jsf7eroBj7DSIvvbD5/SF85rO1u1iQQHif2Na1CyrXX
sJyAU59iVipWgjo1uoGfD8PqnhJdctnTbxu2oYY6MpnQ6K98WI6hwyo/crwUGJU1
nQ8JKEQrirmcbZLsHb1fzmLDsEf2f0prG1QJXA3a9panz3N+TvIXvoWRXLkLgOcj
KjK3NjZOlnsngcXNfaSIeZelskfCg096cUiEnfUeDDc8CaGFPO4uGnhnVo/bcEFM
AuAiegy0/avdVIOU/Ho2o3ON6cQceYlsZD/Viy6oeNSib1Iyu3FLO1ZQMiaPZ6j3
Ewrfag7mr5AOLM11WtYJRYtQh2oLV5hYsvxylxZOGdIJ05hDj/CdEcxYLQ0cv3xJ
xi4shl99rGgYL2NGALrL5pnjCBDBzAdIhKImlSZmurA+29/8iE5If+NJk86SQhNl
lhSF+jIrApsQkl0cTPoE+GPmA9QicMXeLXXB+iJjDG7MVOMX1aeJROmvGWTOxBTS
swFiIgGBQQHE4cjQh8soViVMP7tOkraCYZRYGTxlrFJiCeI38gk7hx0n0hMnfMyy
lzzAKo8Fvt69q6smjOns0MhFVIfT4bUrb0md7KMXqn/OvtP/L/S9IEKjsMvk7yl6
wrLYGYwBeIgfHqPIML0DxOuqV9WKWPoigazdRVW2hQqyEjqbJRG/GIyfaisMxNlT
O+BIdWAsM3f7+gytkvmFo4lnR+Y7yVOL618HSBhie2SFwGNu
<span class="o">=</span>YEJl
<span class="nt">-----END</span> PGP MESSAGE-----
</pre></table></code></div></div><p>M√¨nh c≈©ng kh√¥ng b·∫•t ng·ªù nhi·ªÅu khi n·ªôi dung file ƒë√£ b·ªã m√£ h√≥a v√¨ theo ƒë·ªÅ b√†i th√¨ ch√∫ng ta c·∫ßn t√¨m c√°ch decrypt th√¥ng qua mail m√† user g·ª≠i v√† nh·∫≠n. Ti·∫øp t·ª•c dump c√°c file INBOX, SPAM, TRASH.</p><p>IBOX: Trong ph·∫ßn n√†y m√¨nh ch√∫ √Ω ƒë·∫øn email c·ªßa <code class="language-plaintext highlighter-rouge">ctf.user</code>. Ch√∫ng ta c√≥ ƒëo·∫°n base64 d√†i c·∫ßn decode. K·∫øt qu·∫£ thu ƒë∆∞·ª£c l√† file key ƒë·ªÉ gi·∫£i m√£ PGP. Nh∆∞ng khi m√¨nh import th√¨ l·∫°i c·∫ßn passphrase ƒë·ªÉ m·ªü key. Ti·∫øp t·ª•c ƒëi t√¨m n√†o.</p><p>TRASH: M√¨nh hy v·ªçng l√† user s·∫Ω x√≥a mail ch·ª©a passphrase, tuy nhi√™n th√¨ file n√†y l·∫°i kh√¥ng cho ch√∫ng ta th√¥ng tin g√¨.</p><p>SPAM: Cho m√¨nh m·ªôt chi ti·∫øt r·∫•t quan tr·ªçng: <code class="language-plaintext highlighter-rouge">But we used the same secret as your EN VAR 345YACCESSTOGENERATEP455</code>. M√¨nh ƒë√£ th·ª≠ r·∫•t nhi·ªÅu l·∫ßn <code class="language-plaintext highlighter-rouge">345YACCESSTOGENERATEP455</code> l√† passphrase nh∆∞ng kh√¥ng th√†nh c√¥ng v√† kh√°c l√† stuck. Th√¨ m·ªôt ng∆∞·ªùi em c·ªßa m√¨nh ƒë√£ t√¨m ra v√¨ envars l√† m·ªôt trong nh·ªØng plugin c·ªßa volatility.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="nv">$python2</span> vol.py <span class="nt">-f</span> challenge.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 envars | <span class="nb">grep </span>345YACCESSTOGENERATEP455
Volatility Foundation Volatility Framework 2.6.1
     308 csrss.exe            0x00000000003a1320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     356 wininit.exe          0x000000000043a990 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     364 csrss.exe            0x0000000000181320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     392 winlogon.exe         0x000000000007e060 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     452 services.exe         0x0000000000341320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     460 lsass.exe            0x0000000000351320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     468 lsm.exe              0x0000000000231320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     560 svchost.exe          0x00000000001e1320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     624 svchost.exe          0x0000000000311320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     724 svchost.exe          0x00000000001e1320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     768 svchost.exe          0x0000000000171320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     792 svchost.exe          0x0000000000301320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     964 svchost.exe          0x0000000000351320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     284 svchost.exe          0x00000000001e1320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    1080 spoolsv.exe          0x0000000000161320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    1112 svchost.exe          0x0000000000361320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    1232 armsvc.exe           0x0000000000151320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    1292 svchost.exe          0x0000000000371320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    1784 taskhost.exe         0x00000000001c1320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    1856 dwm.exe              0x0000000000071320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    1884 explorer.exe         0x00000000037cd6b0 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     512 StikyNot.exe         0x00000000003d1320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     832 SSScheduler.ex       0x0000000000501320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    1344 SearchIndexer.       0x000000000040a010 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    1704 SearchProtocol       0x00000000001f1320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     596 notepad.exe          0x00000000002b1320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    1724 notepad.exe          0x0000000000171320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    1852 sppsvc.exe           0x0000000000271320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     304 svchost.exe          0x000000000021d0e0 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     840 notepad.exe          0x0000000000361320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
     992 notepad.exe          0x0000000000221320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    2164 notepad.exe          0x0000000000301320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    2180 SearchFilterHo       0x00000000002a1320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    2308 WmiPrvSE.exe         0x00000000003d1320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    2512 DumpIt.exe           0x0000000000081320 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
    2536 conhost.exe          0x00000000003ad7f0 345YACCESSTOGENERATEP455       pPaAsSpPhHrR445533
</pre></table></code></div></div><p>Decrypt th√¥i n√†o</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nv">$gpg</span> <span class="nt">--import</span> b64.key
<span class="nv">$gpg</span> <span class="nt">-o</span> flag <span class="nt">--decrypt</span> flag.txt.asc
gpg: encrypted with 4096-bit RSA key, ID A986306FA47DE39A, created 2021-08-20
      <span class="s2">"SemahBA (Not too far to get what you want) &lt;SemahBA@fword.tech&gt;"</span>
<span class="nv">$cat</span> flag
We are so proud that we sent you to give him back his important file. 

The important thing was : 23b2e901f3c3c3827a70589efd046be8
</pre></table></code></div></div><p>OK flag ƒë√£ g·∫ßn ho√†n thi·ªán, ch·ªâ c√≤n th·ªùi gian g·ª≠i, m√¨nh c√≥ th·ª≠ 1, 2 l·∫ßn v√¨ time from v√† date ·ªü INBOX kh√°c nhau v√† ra ƒë∆∞·ª£c flag ho√†n thi·ªán.</p><p>Flag: <code class="language-plaintext highlighter-rouge">FwordCTF{08202021-05:03_ctf.user_23b2e901f3c3c3827a70589efd046be8}</code></p><h2 id="elearning">eLearning</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/blog/fword2021/4-eLearning-debai.JPG" alt="IMG" /></p><p>Download: <a href="https://drive.google.com/file/d/1tfcLMAbBWH-KBnkCDAboXAswm5fZuIed/view?usp=sharing">Link 1</a>; <a href="https://mega.nz/file/dwxHXQJa#loOkmUJfr2c1MNoAlue62IJZX4zHpOsW_QrWWdEUdlw">Link 2</a>; <a href="https://www.dropbox.com/s/chp4g30onaumjnm/Challenge2.zip?dl=0">Link 3</a></p><p>ƒê·ªÅ b√†i ta m·ªôt file ·∫£nh n√™n m√¨nh d√πng Autospy ƒë·ªÉ tr√≠ch xu·∫•t d·ªØ li·ªáu.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/blog/fword2021/5-autospy.JPG" alt="IMG" /></p><p>Sau khi ƒë·ªÉ √Ω ·ªü Program Files c√≥ ·ª©ng d·ª•ng Mailbird, m√¨nh google ra ƒë∆∞·ª£c ƒë∆∞·ªùng d·∫´n l∆∞u tr·ªØ l√† <code class="language-plaintext highlighter-rouge">\Users\fword\AppData\Local\Mailbird\Store</code>. ·ªû ƒë√¢y ch√∫ng ta xu·∫•t ra ƒë∆∞·ª£c file l∆∞u tr·ªØ email l√† Store.db, s·ª≠ DB Browser, m√¨nh c√≥ ƒë∆∞·ª£c th√¥ng tin:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/blog/fword2021/6-sender.JPG" alt="IMG" /></p><p>V·∫≠y l√† ƒë√£ c√≥ ƒë∆∞·ª£c th√¥ng tin c·ªßa gi·∫£ng vi√™n. Ph·∫ßn c√≤n l·∫°i m√¨nh ƒë√£ ki·∫øm log c·ªßa dirsearch v√† zenmap nh∆∞ng kh√¥ng cho th√™m k·∫øt qu·∫£ g√¨. Th·ª≠ s·ª≠ d·ª•ng l·ªãch s·ª≠ powershell: <code class="language-plaintext highlighter-rouge">%APPDATA%\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code> ta thu ƒë∆∞·ª£c:</p><pre><code class="language-Powershell">New-Item -ItemType Diretory -Path C:\users\fword\lab01
New-Item -ItemType Directory -Path C:\users\fword\lab01
ls
cd .\lab01\
nmap -sC -sV 192.168.1.9
cd ..\Downloads\dirsearch-master\dirsearch-master\
echo "192.168.1.9          lab01.fword" &gt;&gt; C:\Windows\System32\drivers\etc\hosts
ls
python .\dirsearch.py -u http://lab01.fword -e txt,php 
cd
cd C
cd C:\
cd
cd C
cd C:\
cd
cd C
cd C:\
cd
cd C
cd C:\
cd
cd C
cd C:\
cd
cd C
cd C:\
cd
cd C
cd C:\Users\fword\
wget http://lab01.fword/secret/secret.txt
Rename-Item -Path "c:\Users\fword\secret.txt" -NewName "file.txt"
</code></pre><p>V·∫≠y l√† c√≥ th√™m c√°c tools ƒë√£ d√πng: dirsearch-nmap-wget. Ti·∫øp theo ta ƒë·ªçc file.txt ·ªü th·ª≠ m·ª•c Document: <code class="language-plaintext highlighter-rouge">663cd2dfc9418f384d90c89a15319b3d</code></p><p>Flag: <code class="language-plaintext highlighter-rouge">FwordCTF{SBA_192.168.1.9_dirsearch-nmap-wget_secret.txt_663cd2dfc9418f384d90c89a15319b3d}</code></p><h2 id="shshsh">shshsh</h2><p>L·∫°i l√† m·ªôt th·ª≠ th√°ch v·ªÅ memory forensics.</p><p>Tuy nhi√™n th·ª≠ th√°ch n√†y l·∫°i kh√¥ng c√≥ b·∫•t k√¨ process hay th√¥ng tin g√¨ kh·∫£ nghi. N√™n m√¨nh th·ª≠ ki·ªÉm tra bi·∫øn m√¥i tr∆∞·ªùng.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python vol.py <span class="nt">-f</span> chall.vmem <span class="nt">--profile</span><span class="o">=</span>WinXPSP2x86 envars

....

1552 explorer.exe         0x00010000 k1                             12a45652a154a358452124565487ad0
1552 explorer.exe         0x00010000 iv                             k1
1552 explorer.exe         0x00010000 KT                             AES128-CBC
1552 explorer.exe         0x00010000 LOGONSERVER                    <span class="se">\\</span>CTFCREATORS-DF

....
</pre></table></code></div></div><p>Ch√∫ng ta c√≥ key v√† iv c·ªßa thu·∫≠t to√°n m√£ h√≥a AES128-CBC; tuy nhi√™n l·∫°i kh√¥ng c√≥ t·ªáp m√£ h√≥a.</p><p>ƒêo·∫°n n√†y th√¨ m√¨nh c≈©ng m√≤ m√£i ƒë·∫øn l√∫c sau th√¨ m·ªõi th·∫•y b·ªè x√≥t 1 ph·∫ßn quan tr·ªçng trong c√°c bi·∫øn m√¥i tr∆∞·ªùng:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>1552 explorer.exe         0x00010000 PATHEXT                        .HAK<span class="p">;</span>.COM<span class="p">;</span>.EXE<span class="p">;</span>.BAT<span class="p">;</span>.CMD<span class="p">;</span>.VBS<span class="p">;</span>.VBE<span class="p">;</span>.JS<span class="p">;</span>.JSE<span class="p">;</span>.WSF<span class="p">;</span>
</pre></table></code></div></div><p>Ch·ªâ duy nh·∫•t PATHEXT c·ªßa explorer l√† c√≥ ƒëu√¥i m·ªü r·ªông r·∫•t l·∫° l√† .HAK; th·ª≠ t√¨m xem c√≥ bao nhi√™u file .HAK n√†o.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python vol.py <span class="nt">-f</span> chall.vmem <span class="nt">--profile</span><span class="o">=</span>WinXPSP2x86 filescan | <span class="nb">grep</span> <span class="nt">-i</span> <span class="s2">".HAK"</span>
Volatility Foundation Volatility Framework 2.6.1
0x00000000012403d8      1      0 <span class="nt">-W-rw-</span> <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume1<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32<span class="se">\H</span>andles.HAK
0x000000000198c0d0      2      2 R--rw- <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume1<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32<span class="se">\H</span>andles.HAK

<span class="nv">$ </span>python vol.py <span class="nt">-f</span> chall.vmem <span class="nt">--profile</span><span class="o">=</span>WinXPSP2x86 dumpfiles <span class="nt">-Q</span> 0x00000000012403d8 <span class="nt">-D</span> <span class="nb">.</span>

<span class="nv">$ </span>strings file.None.0x8144e990.dat 
<span class="nv">NDgwYjJmMzM4ZjY0N2M3ZTY1MjQwZTc2MjdjYWRhYmFjNWJkNWZjNjllNWQxZDMzM2ZlYjRlMjNjYzNhYjA5NGZlY2E1ODcxMjA5ODJmODExM2U0NTMzNjcxOThmMDU4MWJlZDNhZWMxNTBkMjg1NDIzYWUxMTFiN2I5NDkzNjExZmFjMmNmYmViYjg5NzkzY2U3MThjM2YxZTJkNWNlMjcwMmE5MWNjNDM4NzZhYjJmZGJjZjc0MmRlODg4M2Q2OTIzYjAwYTYyNTMzMGRhOWRiNjljNmFiYmU0ZjIxY2Y5NGJiZmMxMWU2MWJkZDc0NmVjNDU5OGRkNTQ2ZDk2YQo</span><span class="o">=</span>
</pre></table></code></div></div><p>Decrypt th√¥i n√†o <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/blog/fword2021/9-shshsh.JPG" alt="IMG" /></p><p>Flag: <code class="language-plaintext highlighter-rouge">FwordCTF{y0u_CAN_Mak3_u5e_of_4ny_proCesS_with_tHe_ri9ht_apProach}</code></p><p>Cheer (‚òûÔæü„ÉÆÔæü)‚òû ‚òú(Ôæü„ÉÆÔæü‚òú)</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeup/'>Writeup</a>, <a href='/categories/fwordctf-2021/'>FwordCTF 2021</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/forensics/" class="post-tag no-text-decoration" >forensics</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/fwordctf/" class="post-tag no-text-decoration" >FwordCTF</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[Writeup] FwordCTF 2021 - Forensics - V√¥ Di·ªán (@F4c3l3ss_)&url=https://v0dien.github.io/posts/Writeup-FwordCTF-2021-Forensics/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[Writeup] FwordCTF 2021 - Forensics - V√¥ Di·ªán (@F4c3l3ss_)&u=https://v0dien.github.io/posts/Writeup-FwordCTF-2021-Forensics/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=[Writeup] FwordCTF 2021 - Forensics - V√¥ Di·ªán (@F4c3l3ss_)&url=https://v0dien.github.io/posts/Writeup-FwordCTF-2021-Forensics/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Writeup-FwordCTF-2021-Forensics/">[Writeup] FwordCTF 2021 - Forensics</a><li><a href="/posts/Hexion-CTF-2020/">[Writeup] Hexion CTF 2020</a><li><a href="/posts/Decompile-va-Recompile-APK/">Decompile v√† Recompile ·ª©ng d·ª•ng APK</a><li><a href="/posts/USB-PCAP-P1-Keyboard/">USB PCAP - Ph·∫ßn 1 B√†n ph√≠m</a><li><a href="/posts/Writeup-Dien-tap-ATTT-NHNN-03-2021/">[Writeup] Di·ªÖn t·∫≠p ATTT Ng√¢n h√†ng Nh√† N∆∞·ªõc 31/03/2021</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/research/">research</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apache/">apache</a> <a class="post-tag" href="/tags/asis/">ASIS</a> <a class="post-tag" href="/tags/bsides/">BSides</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Writeup-VNPT-Secathon-2018/"><div class="card-body"> <span class="timeago small" > Mar 20, 2018 <i class="unloaded">2018-03-20T00:00:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Writeup] VPNT Secathon 2018 - Misc</h3><div class="text-muted small"><p> Chayngaydi Trong b√†i n√†y ban t·ªï ch·ª©c cho ch√∫ng ta ƒëo·∫°n teaser trailer Ch·∫°y ngay ƒëi c·ªßa S·∫øp. Ngay khi nh√¨n v√†o dung l∆∞·ª£ng c·ªßa t·∫≠p tin mp4, th√¨ m√¨nh bi·∫øt ch·∫Øc ch·∫Øn r·∫±ng n√≥ ƒëang gi·∫•u m·ªôt file g√¨ ƒë...</p></div></div></a></div><div class="card"> <a href="/posts/Writeup-BSides-Noida-CTF-2021-Deathnote/"><div class="card-body"> <span class="timeago small" > Aug 8 <i class="unloaded">2021-08-08T00:00:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Writeup] BSides Noida CTF 2021 - Deathnote</h3><div class="text-muted small"><p> B√†i n√†y cho ch√∫ng ta 1 vuln box tr√™n tryhackme v√† nhi·ªám v·ª• l√† ph·∫£i cat ƒë∆∞·ª£c flag trong root folder. ƒê·∫ßu ti√™n, m√¨nh d√πng nmap ƒë·ªÉ xem c√°c port ƒëang m·ªü tr√™n box n√†y. $ nmap -vv -sV -sT -sC 10.10.164....</p></div></div></a></div><div class="card"> <a href="/posts/Mates-SS2-Round-4-Forensics-caigidzay/"><div class="card-body"> <span class="timeago small" > May 1, 2018 <i class="unloaded">2018-05-01T00:00:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Writeup] Mates SS2 Round 4 - Forensics caigidzay</h3><div class="text-muted small"><p> Trong th·ª≠ th√°ch n√†y ƒë·ªÉ b√†i l√† m·ªôt file dump, mbr/dos n√™n m√¨nh s·∫Ω d√πng auto spy ƒë·ªÉ m·ªü n√≥ xem sao. ƒê·∫≠p v√†o m·∫Øt m√¨nh l√† flag.jpg. M√¨nh t·ªën kha kh√° th·ªùi gian v·ªõi b·ª©c ·∫£nh n√†y v√¨ l√∫c ƒë·∫ßu t∆∞·ªüng ƒë√¢y l√† ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Writeup-corCTF-2021/" class="btn btn-outline-primary"><p>[Writeup] corCTF 2021</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> ¬© 2021 <a href="https://twitter.com/F4c3l3ss_">V√¥ Di·ªán (@F4c3l3ss_)</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/research/">research</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apache/">apache</a> <a class="post-tag" href="/tags/asis/">ASIS</a> <a class="post-tag" href="/tags/bsides/">BSides</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://v0dien.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
